
<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <title>Encuesta de Confianza Institucional</title>
  <script>
    document.addEventListener('visibilitychange', function () {
      if (document.hidden) {
        alert("Por favor, no cambies de pestaña mientras respondes la encuesta.");
      }
    });

    function enviarFormulario(e) {
      e.preventDefault();
      const form = document.forms['formularioEncuesta'];
      fetch('https://script.google.com/macros/s/TU_SCRIPT_ID/exec', {
        method: 'POST',
        body: new FormData(form)
      }).then(response => {
        alert('Respuesta enviada. ¡Gracias!');
        form.reset();
      }).catch(error => alert('Error al enviar: ' + error.message));
    }

    const historias = {
      "activista": "A finales de los años 70s y principios de los 80s, Jorge Inzunza fue parte del Frente Nacional Contra la Represión...",
      "experto": "Jorge Inzunza ha trabajado como consultor independiente en derechos humanos para empresas y universidades...",
      "servidor_publico": "Antes de ser designado, Jorge Inzunza fue Visitador Adjunto de la CEDH y asesor jurídico de la CEAV...",
      "politico_confianza": "Jorge Inzunza ha sido diputado federal y local, así como funcionario en gobiernos municipales y estatales...",
      "politico_partidista": "Inzunza ha ocupado cargos en el partido Morena desde 2012 y fue asesor parlamentario hasta 2024...",
      "cliente_militante": "Inzunza trabajó en CEDH y CEAV, pero también ha sido militante y representante electoral del partido Morena..."
    };

    const claves = Object.keys(historias);
    const seleccion = claves[Math.floor(Math.random() * claves.length)];

    window.addEventListener("DOMContentLoaded", () => {
      document.getElementById("historiaTexto").innerText = historias[seleccion];
      document.getElementById("perfilSeleccionado").value = seleccion;
    });
  </script>
</head>
<body>
  <h1>Encuesta de Confianza Institucional</h1>
  <form name="formularioEncuesta" onsubmit="enviarFormulario(event)">
    <input type="hidden" name="perfilSeleccionado" id="perfilSeleccionado" />
    <p><strong>Lee la siguiente historia antes de continuar:</strong></p>
    <div id="historiaTexto" style="border:1px solid #ccc; padding:10px; background:#f9f9f9;"></div><br>

    <!-- Ejemplo mínimo de campos, tú puedes extender con los demás -->
    <label>Edad:</label><input type="number" name="edad" required><br>
    <label>Género:</label>
    <select name="genero" required>
      <option value="">Selecciona</option>
      <option>Masculino</option>
      <option>Femenino</option>
      <option>Otro</option>
    </select><br><br>

    <input type="submit" value="Enviar respuestas">
  </form>
</body>
</html>
