
<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <title>Encuesta de Confianza Institucional</title>
  <script>
    document.addEventListener('visibilitychange', function () {
      if (document.hidden) {
        alert("Por favor, no cambies de pestaña mientras respondes la encuesta.");
      }
    });
    function enviarFormulario(e) {
      e.preventDefault();
      const form = document.forms['formularioEncuesta'];
      fetch('https://script.google.com/macros/s/TU_SCRIPT_ID/exec', {
        method: 'POST',
        body: new FormData(form)
      }).then(response => {
        alert('Respuesta enviada. ¡Gracias!');
        form.reset();
      }).catch(error => alert('Error al enviar: ' + error.message));
    }
    const historias = {
      "activista": "Historia Activista...",
      "experto": "Historia Experto...",
      "servidor_publico": "Historia Servidor Público...",
      "politico_confianza": "Historia Político de Confianza...",
      "politico_partidista": "Historia Político Partidista...",
      "cliente_militante": "Historia Profesional Clientelismo..."
    };
    const claves = Object.keys(historias);
    const seleccion = claves[Math.floor(Math.random() * claves.length)];
    window.addEventListener("DOMContentLoaded", () => {
      document.getElementById("historiaTexto").innerText = historias[seleccion];
      document.getElementById("perfilSeleccionado").value = seleccion;
    });
  </script>
</head>
<body>
  <h1>Encuesta de Confianza Institucional</h1>
  <form name="formularioEncuesta" onsubmit="enviarFormulario(event)">
    <p><strong>Por favor, lee la siguiente historia antes de responder:</strong></p>
    <div id="historiaTexto" style="border:1px solid #ccc; padding:10px; background:#f9f9f9;"></div>
    <input type="hidden" name="perfilSeleccionado" id="perfilSeleccionado" />
    <input type="submit" value="Enviar respuestas">
  </form>
</body>
</html>
